{% extends "datasets/base_dataset.html" %}
{% load static %}
{% block content %}
	<style type="text/css">
		body,html{
			height: 100%;
		}
	</style>
	<link rel="stylesheet" type="text/css" href="{% static 'datasets/css/grid.css' %}">
	<div class='jumbotron not-modal-jumbotron' align=center style='overflow:scroll;height:50%;resize:both'>
		<img src="https://res.cloudinary.com/dgofwp0my/image/upload/q_100/v1505907556/dra_172_artifical_intelligence_change_energy_jynxp2.gif" style='object-fit:cover;'>
		<button id='can_continue' type="button" class="submit-btn btn btn-primary" style='display:none;'><h1 style='color:yellow'>Continue</h1></button>
	</div><br><br>
	<div class='ajax_part_of_page' style='text-align:center;height:100%;overflow:scroll'>
		{% if user.is_authenticated and user.datasets.count > 0 %}
			<h1>Choose an existing DataSet or a new one</h1>
			<div class="grid-container" align=center>
				{% for dataset in user.datasets.all  %}
					{% include "datasets/_datasets_selectable_list.html" %}
					
					
				{% endfor %}
			</div>
		{% else %}
			
			<h1>Choose New Dataset</h1>
			
		{% endif %}
		
		<div class='grid-container'>
			<a style='background-color:green;' id='create' class='grid-item' title='add a new dataset' class='nav-link' href="{% url 'datasets:choose_new_dataset' %}" data-toggle="modal" data-target="#modal"><h1>New DataSet</h1><br>
				<i class="fas fa-plus-circle fa-5x"></i>
			</a>
			
		</div>
	</div>
	<script type="text/javascript" src='{% static "datasets/js/populate_popup_detail_view.js" %}'></script>
	<script type="text/javascript">
		
		$('.grid-item').not('#create').click(function(){
			$('#can_continue').css('display','block');
			$('.grid-item').removeClass('higlight_selected');
			$(this).addClass("higlight_selected");
			
		});
		$('#can_continue').click(function(){
				$('#can_continue').css('display','none');
				var ajax_part_of_page = $('.ajax_part_of_page');
				var selected_dataset = $('.higlight_selected');
				var current_dataset_location = $(selected_dataset).find('#dataset_location').text();
				var current_dataset_pk = $(selected_dataset).find('.view').attr('id');
				Cookies.set('primary_key',current_dataset_pk,{path:'/'});
				Cookies.set('dataset_location', current_dataset_location, {path: '/' });
				$('.jumbotron').html('<img src="https://theplaycave.com.au/wp-content/uploads/2016/10/loading.gif">');
				$.get('{% url "datasets:selected_dataset" %}',function(response){
					$('.jumbotron').html(response);
				});
				$('#can_continue').remove();
				$(ajax_part_of_page).html('<img src="https://theplaycave.com.au/wp-content/uploads/2016/10/loading.gif">')
				$.get('{% url "datasets:classification_or_regression" %}',function(response){
				
					$(ajax_part_of_page).html(response);
				
				});
		});
		$('.ajax_part_of_page').on('click','#regression',function(){
			Cookies.set('label_is','continuous',{path:'/'})
			$('.ajax_part_of_page').html('<div align="center"><img src="https://theplaycave.com.au/wp-content/uploads/2016/10/loading.gif"></div>')
			$.get('{% url "datasets:label_column" %}',function(response){
				$('.ajax_part_of_page').html(response);
		});
		});
		$('.ajax_part_of_page').on('click','#classification',function(){
			Cookies.set('label_is','discrete',{path:'/'})
			$('.ajax_part_of_page').html('<div align="center"><img src="https://theplaycave.com.au/wp-content/uploads/2016/10/loading.gif"></div>')
			$.get('{% url "datasets:label_column" %}',function(response){
				$('.ajax_part_of_page').html(response);
		});
			
		});
	</script>
{% endblock content %}